import{_ as z,r as o,c as k,o as R,b as C,f as D,i as x,p as K,q as L,d as e,n as y,t as a,T as O,a as Q,s as W,l as A,v as U,x as X,h as Y}from"./index-Cz9aqF_s.js";import{u as Z}from"./bot-D3weyv_4.js";const ee={key:0,class:"fixed bottom-4 right-4 z-50"},te={__name:"NotificationToast",props:{notificationMessage:String,notificationType:{type:String,default:"success",validator:m=>["success","error","info"].includes(m)},notificationDuration:{type:Number,default:3e3}},setup(m){const l=m,b=o(!1),d=k(()=>({success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"})[l.notificationType]);return R(()=>{b.value=!0,setTimeout(()=>{b.value=!1},l.notificationDuration)}),(B,n)=>b.value?(x(),C("div",ee,[K(O,{name:"fade"},{default:L(()=>[e("div",{class:y(["px-6 py-4 rounded-md shadow-lg text-white",d.value])},a(m.notificationMessage),3)]),_:1})])):D("",!0)}},se=z(te,[["__scopeId","data-v-e95cb916"]]),oe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 bg-gray-50 dark:bg-gray-900 min-h-screen"},ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6"},re={class:"flex items-center justify-between mb-4"},ne={class:"flex items-center space-x-4"},ie={class:"text-2xl font-bold text-gray-900 dark:text-white"},le={class:"flex gap-2"},ue=["disabled"],de=["disabled"],ce={class:"flex items-center space-x-4 my-4"},ge={key:0,class:"px-3 py-1 rounded-md text-sm font-medium bg-red-100 dark:bg-red-900 dark:text-red-200 text-red-800"},fe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},me={class:"space-y-6"},be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6"},pe={class:"grid grid-cols-2 gap-4 mb-4"},ve={class:"text-lg font-medium dark:text-white"},xe={class:"text-lg font-medium text-gray-600 dark:text-gray-300"},ye={class:"text-lg font-medium text-gray-600 dark:text-gray-300"},he={class:"space-y-6"},we={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6"},_e={class:"space-y-4"},ke={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full"},Ce={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800"},De={class:"mt-3 text-center"},Be={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},Se={class:"mt-2 px-7 py-3"},Ne={class:"text-gray-600 dark:text-gray-300"},Te={__name:"BotStatus",setup(m){const l=X(),b=Y(),d=Z(),B=o(""),n=o({}),g=o({mode:"",errorMessage:"",dailyProfitPercentage:0}),u=o({initialDeposit:0,currentDeposit:0}),T=o({dailyProfitAmount:0}),c=o(!1),$=o(0),S=o(null),h=o(!1),p=o({isVisible:!1,message:"",type:"success"}),N=o(!1),P=o(""),V=o(""),w=o(null);k(()=>Number(u.value.currentDeposit)-Number(u.value.initialDeposit)),k(()=>Number(T.value.dailyProfitAmount));const j=k(()=>{const s=g.value.mode;return s?s.includes("Ошибка")?"bg-red-100 text-red-800":s.includes("Работает")?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800":"bg-blue-100 text-blue-800"}),_=s=>Number(s||0).toFixed(n.value.digitprice),i=(s,t="success")=>{p.value={isVisible:!0,message:s,type:t},setTimeout(()=>{p.value.isVisible=!1},3e3)},v=async()=>{var s,t,f,I;if(!l.query.id){i("ID бота не указан","error");return}try{const r=await d.fetchBotStatus(l.query.id);r&&(console.log("Response data:",r),B.value=r.botname||"Без названия",g.value=r.status,n.value=r.settings,u.value={initialDeposit:((s=r.finance)==null?void 0:s.startdepo)||0,currentDeposit:((t=r.finance)==null?void 0:t.depo)||0},T.value={dailyProfitAmount:((f=r.sales)==null?void 0:f.salesTodaySum)||0},c.value=!!r.onoff,$.value=Number(((I=r.status)==null?void 0:I.currentprice)||0))}catch(r){console.error("Ошибка загрузки данных:",r),i("Ошибка загрузки данных","error")}},M=async()=>{try{await d.toggleBot(l.query.id,c.value),i(c.value?"Бот остановлен":"Бот запущен"),await v()}catch(s){console.error("Ошибка переключения бота:",s),i("Ошибка переключения бота","error")}},E=async()=>{try{await d.updateBotSettings(l.query.id,n.value),i("Настройки сохранены"),h.value=!1,await v()}catch(s){console.error("Ошибка сохранения настроек:",s),i("Ошибка сохранения настроек","error")}},G=async()=>{try{await d.resetBot(l.query.id),i("Настройки сброшены"),h.value=!1,await v()}catch(s){console.error("Ошибка сброса настроек:",s),i("Ошибка сброса настроек","error")}},H=()=>{P.value="Подтверждение удаления",V.value="Вы уверены, что хотите удалить этого бота?",w.value=async()=>{try{await d.deleteBot(l.query.id),i("Бот удален"),b.push("/")}catch(s){console.error("Ошибка удаления бота:",s),i("Ошибка удаления бота","error")}},N.value=!0},J=async()=>{w.value&&await w.value(),q()},q=()=>{N.value=!1,w.value=null},F=()=>{h.value=!0};return R(()=>{v(),S.value=setInterval(()=>{h.value||v()},2e3)}),Q(()=>{S.value&&clearInterval(S.value)}),(s,t)=>(x(),C("div",oe,[p.value.isVisible?(x(),W(se,{key:0,"notification-message":p.value.message,"notification-type":p.value.type},null,8,["notification-message","notification-type"])):D("",!0),e("div",ae,[e("div",re,[e("div",ne,[e("span",ie,a(B.value||"Без названия"),1)])]),e("div",le,[e("button",{onClick:M,disabled:c.value,class:y(["w-full px-4 py-2 text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2",c.value?"text-gray-400 bg-gray-300 dark:bg-gray-600 cursor-not-allowed focus:ring-gray-300":"text-white bg-green-600 hover:bg-green-500 focus:ring-green-500"])}," Старт ",10,ue),e("button",{onClick:M,disabled:!c.value,class:y(["w-full px-4 py-2 text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2",c.value?"text-white bg-red-600 hover:bg-red-500 focus:ring-red-500":"text-gray-400 bg-gray-300 dark:bg-gray-600 cursor-not-allowed focus:ring-gray-300"])}," Стоп ",10,de),e("button",{onClick:G,class:"w-full px-4 py-2 text-sm text-white bg-orange-600 hover:bg-orange-500 focus:ring-red-500 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2"}," Сброс ")]),e("div",ce,[e("span",{class:y(["px-3 py-1 rounded-md text-sm font-medium",j.value])},a(g.value.rezhim||"Не определен"),3),g.value.errmsg?(x(),C("span",ge,a(g.value.errmsg),1)):D("",!0)])]),e("div",fe,[e("div",me,[e("div",be,[t[6]||(t[6]=e("h2",{class:"text-lg font-semibold mb-4 dark:text-white"},"Текущий статус",-1)),e("div",pe,[e("div",null,[t[2]||(t[2]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Текущая цена",-1)),e("p",ve,a(_(g.value.currentprice)),1)]),e("div",null,[t[3]||(t[3]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Стартовый баланс",-1)),e("p",xe,a(_(u.value.initialDeposit))+" "+a(n.value.basecoin),1)]),e("div",null,[t[4]||(t[4]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Текущий баланс",-1)),e("p",ye,a(_(u.value.currentDeposit))+" "+a(n.value.basecoin),1)]),e("div",null,[t[5]||(t[5]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Прибыль / убыток",-1)),e("p",{class:y(["text-lg font-medium",u.value.currentDeposit-u.value.initialDeposit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},a(_(u.value.currentDeposit-u.value.initialDeposit))+" "+a(n.value.basecoin),3)])])])]),e("div",he,[e("div",we,[t[9]||(t[9]=e("h2",{class:"text-lg font-semibold mb-4 dark:text-white"},"Настройки бота",-1)),e("div",_e,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Stop Price (% от текущей цены)",-1)),A(e("input",{type:"number",step:"0.1","onUpdate:modelValue":t[0]||(t[0]=f=>n.value.offsettop=f),onFocus:F,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,544),[[U,n.value.offsettop,void 0,{number:!0}]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Price (% от Stop Price)",-1)),A(e("input",{type:"number",step:"0.1","onUpdate:modelValue":t[1]||(t[1]=f=>n.value.offsetbottom=f),onFocus:F,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,544),[[U,n.value.offsetbottom,void 0,{number:!0}]])]),e("button",{onClick:E,class:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Сохранить настройки "),e("div",{class:"space-y-3 mt-4"},[e("button",{onClick:H,class:"w-full px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Удалить бота ")])])])])]),N.value?(x(),C("div",ke,[e("div",Ce,[e("div",De,[e("h3",Be,a(P.value),1),e("div",Se,[e("p",Ne,a(V.value),1)]),e("div",{class:"items-center px-4 py-3"},[e("button",{onClick:J,class:"px-4 py-2 bg-blue-600 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Подтвердить "),e("button",{onClick:q,class:"mt-3 px-4 py-2 bg-gray-100 dark:bg-gray-600 dark:text-white text-gray-700 text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Отмена ")])])])])):D("",!0)]))}},Me=z(Te,[["__scopeId","data-v-7df6dbb6"]]);export{Me as default};
